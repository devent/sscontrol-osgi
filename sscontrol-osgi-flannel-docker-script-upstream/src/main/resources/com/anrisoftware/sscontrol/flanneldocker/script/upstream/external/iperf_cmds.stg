/*
 * Starts iperf server. Returns the IP address of the container.
 */
startServer(parent, vars) ::= <<
container_id=\$(docker run -d -p 5201:5201 moutten/iperf:latest)
docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' \$container_id
>>

/*
 * Starts iperf client.
 *
 * Mandatory:
 *
 * vars.address
 */
startClient(parent, vars) ::= <<
docker run -it --rm moutten/iperf:latest iperf3 -c <vars.address>
>>
