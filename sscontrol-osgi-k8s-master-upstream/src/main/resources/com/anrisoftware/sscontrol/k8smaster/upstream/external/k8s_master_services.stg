kubeApiserverService(parent, vars) ::= <<
# Authors
# https://koji.fedoraproject.org/koji/buildinfo?buildID=831577
[Unit]
Description=Kubernetes API Server
Documentation=https://github.com/GoogleCloudPlatform/kubernetes
After=network.target
After=etcd.service

[Service]
EnvironmentFile=-<parent.configDir>/config
EnvironmentFile=-<parent.configDir>/apiserver
User=<parent.user>
ExecStart=<parent.binDir>/kube-apiserver \
        $KUBE_LOGTOSTDERR \
        $KUBE_LOG_LEVEL \
        $KUBE_ETCD_SERVERS \
        $KUBE_ETCD_TLS \
        $KUBE_API_ADDRESS \
        $KUBE_API_PORT \
        $KUBELET_PORT \
        $KUBE_ALLOW_PRIV \
        $KUBE_SERVICE_ADDRESSES \
        $KUBE_ADMISSION_CONTROL \
        $KUBE_TLS_CA \
        $KUBE_TLS_CERT \
        $KUBE_AUTHENTICATION \
        $KUBE_SERVICE_ACCOUNT_KEY \
        $KUBELET_PREFERRED_ADDRESS_TYPES \
        $KUBELET_TLS \
        $KUBE_API_ARGS
Restart=on-failure
Type=notify
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target

>>

kubeControllerManagerService(parent, vars) ::= <<
# Authors
# https://koji.fedoraproject.org/koji/buildinfo?buildID=831577
[Unit]
Description=Kubernetes Controller Manager
Documentation=https://github.com/GoogleCloudPlatform/kubernetes

[Service]
EnvironmentFile=-<parent.configDir>/config
EnvironmentFile=-<parent.configDir>/controller-manager
User=kube
ExecStart=<parent.binDir>/kube-controller-manager \
        $KUBE_LOGTOSTDERR \
        $KUBE_LOG_LEVEL \
        $KUBE_MASTER \
        $KUBE_CONTROLLER_MANAGER_ARGS
Restart=on-failure
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target

>>

kubeSchedulerService(parent, vars) ::= <<
# Authors
# https://koji.fedoraproject.org/koji/buildinfo?buildID=831577
[Unit]
Description=Kubernetes Scheduler Plugin
Documentation=https://github.com/GoogleCloudPlatform/kubernetes

[Service]
EnvironmentFile=-<parent.configDir>/config
EnvironmentFile=-<parent.configDir>/scheduler
User=kube
ExecStart=<parent.binDir>/kube-scheduler \
        $KUBE_LOGTOSTDERR \
        $KUBE_LOG_LEVEL \
        $KUBE_MASTER \
        $KUBE_SCHEDULER_ARGS
Restart=on-failure
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target

>>

servicesKubernetesConf(parent, vars) ::= <<
# Authors
# https://koji.fedoraproject.org/koji/buildinfo?buildID=831577
d /var/run/kubernetes 0755 <parent.user> <parent.user> -

>>
