rsyncCmd(parent, vars) ::= <<
set -e

<if(vars.config)>
config=$(mktemp)
trap "{ rm -f $config; }" EXIT

cat \<\<EOF > $config
Host *
<vars.config>
EOF
<endif>

rsync <if(vars.config)>-e "ssh -o StrictHostKeyChecking=no -F $config"<endif> -r -v -z <vars.rsync.user>@<vars.rsync.host>:<vars.path>/\* .

>>
